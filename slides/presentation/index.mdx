import UIExampleImage from "../assets/wss-ui-example.jpg"
import StateOverview from "../assets/state-overview.png"
import SpongebobHooks from "../assets/Fish_Hooks_Park.png"
import InterfaceDemo from "./components/InterfaceDemo.jsx"

import { DarkSlide, CodeSlide } from "./slides"
import { Image } from "spectacle"

# Realtime Web Applications With Websockets + Hooks

<br />
<br />
<br />

### Kyle Cesmat - Software Engineer at Formidable

---

## The Challenge ⚡️

- UI with ~6 realtime websocket interfaces
- Some of these components are charts/graphs with many DOM nodes
- 300ms render target
- Maintain performance 📈

---

## <InterfaceDemo />

---

export default DarkSlide

## Epilepsy inducing warning

---

## <InterfaceDemo isFlashing={true} isRandom={true}/>

---

## Where we landed

- Websocket connections update singular store
- Use rxjs to 'scan' for updates every 300ms 👾
- Singular `setState` call, triggering update to components

---

<Image src={StateOverview} style={{ maxHeight: "1000px" }} />

---

## <InterfaceDemo isFlashing={true}/>

---

## Lessons learned

- Requires _all_ sockets to be opened
- Doesn't scale well, we're setting a lot of state at once
- We can now take advantage of hooks 🎉 🎣

---

export default DarkSlide

<Image src={SpongebobHooks} style={{ maxHeight: "1000px" }} />

---

## What are hooks?

- They let you use state and other React features without writing a class
- Provides _opinions_ about managing state
- Extensible, functional, and will blow your mind

---

export default CodeSlide

```javascript
import { useRef, useState, useEffect } from "react"

function App() {
  const [hoverRef, isHovered] = useHover()
  return <div ref={hoverRef}>{isHovered ? "YES" : "NO"}</div>
}

function useHover() {
  const [value, setValue] = useState(false)
  const ref = useRef(null)
  const handleMouseOver = () => setValue(true)
  const handleMouseOut = () => setValue(false)

  useEffect(() => {
    if (ref.current) {
      node.addEventListener("mouseover", handleMouseOver)
      node.addEventListener("mouseout", handleMouseOut)
      return () => {
        node.removeEventListener("mouseover", handleMouseOver)
        node.removeEventListener("mouseout", handleMouseOut)
      }
    }
  }, [ref.current])

  return [ref, value]
}
```

---

## 💻 Demo 👀

<br />

### useWebsocket & useImmutableReducer

---

### Wrap up
